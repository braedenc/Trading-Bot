Trading Bot PRD (v 0.4 — 20 Jun 2025)
1 – Overview
A modular, async trading engine capable of plugging in any number of strategy "agents."

Engine: Python asyncio + Supabase (Postgres) + IBKR

Data: 1-minute OHLCV bars + in-memory 20-tick buffer

Agents: Each lives in trading_bot/agents/ and inherits BaseAgent.

External strategies: The original ai-hedge-fund repo is included as a read-only submodule under external/ai-hedge-fund/; wrapped by GitHubAgent.

Dashboard: Autogenerated via Lovable.dev reading Supabase tables.

2 – Current Repo Layout (cleaned 20 Jun 2025)
pgsql
Copy
Edit
Trading-Bot/
├── docs/                 ← PRD & other design docs
├── external/ai-hedge-fund (submodule)
├── trading_bot/          ← engine + agents
├── requirements.txt
├── README.md / LICENSE / .git*
└── infra/supabase/       ← schema.sql (DDL)
3 – Goals & KPIs
KPI	Target (MVP)
90-day Sharpe	≥ 1.5
Hit-rate	≥ 55 %
Intraday drawdown	≤ 2 % AUM
Signal → Broker ACK latency	≤ 600 ms
Engine uptime (RTH)	≥ 99 %

4 – Functional Roadmap
Milestone	Target date	Status
M1 – Clean repo & submodule wrapper	20 Jun 2025	✅ done
M2 – Hourly risk_limits refresh (Supabase)	24 Jun 2025	⬜
M3 – Lovable.dev dashboard v0.1 (positions + P/L)	01 Jul 2025	⬜
M4 – Full paper-trade loop (IBKR demo)	05 Jul 2025	⬜
M5 – First live micro-allocation (risk-capped)	12 Jul 2025	⬜

5 – Functional Requirements (delta from v 0.3)
Risk-limits service

Pull risk_limits table every hour via Supabase REST; hot-reload in engine.

Agent discovery

Engine auto-loads any trading_bot/agents/*/strategy.py implementing GitHubAgent, SMAAgent, etc.; no manual registration required.

CLI flags

--dry-run (existing)

--paper → sends orders to IBKR demo; persists fills.

Dashboard

Lovable.dev scaffold; real-time Supabase positions & metrics_daily display.

6 – Non-Functional Requirements (updated)
Category	Requirement
Security	Credentials loaded via .env; never committed.
Performance	Engine CPU ≤ 70 % on t3.medium; RAM ≤ 50 MB per agent.
Observability	Structured JSON logs → Loki/Grafana Cloud; OpenTelemetry traces.
Compliance	Submodule keeps upstream GPL/MIT text isolated; root license is MIT.

7 – Data Schema Snapshot (unchanged)
quotes_1m, orders, fills, positions, metrics_daily, risk_limits
(DDL lives in infra/supabase/schema.sql)

8 – Open Questions
Dashboard auth: stick with single-user or add Supabase RLS?

Tick-buffer size: 20 ticks enough for exit logic?

Preferred CI provider (GitHub Actions vs. Cloudflare Workers) for lint + smoke tests?

9 – Glossary
Engine – async loop dispatching snapshots → agents → risk filter → broker

Agent – strategy class returning order dicts

Snapshot – latest bar + tick cache dict

Submodule – read-only copy of upstream repo, updated via git submodule update --remote 